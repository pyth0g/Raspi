<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Create QRD</title>
    <style>
        @media (max-width: 1000px) {
            body, html {
                background-color: black;
                color: white;
                font-family: 'Courier New', monospace;
                margin: 0;
                padding: 0;
                height: 100%;
                overflow: hidden;
            }

            h1.title {
                text-align: center;
                font-size: 2rem;
                margin: 40px 0 20px 0;
            }

            .submit_form {
                display: flex;
                flex-direction: column;
                max-width: 100%;
                width: 80vw;
                margin: 0 auto;
            }

            .set {
                width: 10%;
                box-sizing: border-box;
                padding: 0px;
                font-size: 0.8rem;
            }

            .container {
                position: relative;
                display: flex;
                align-items: center;
                width: 100%;
                max-width: 100%;
            }

            .static-label {
                position: absolute;
                left: 8px;
                z-index: 1;
                pointer-events: none;
                color: white;
            }

            .new {
                background-color: black;
                color: white;
                border: none;
                padding-left: 21.65ch;
                width: 100%;
                box-sizing: border-box;
                font-family: 'Courier New', monospace;
                font-size: 1rem;
            }

            .center {
                display: flex;
                justify-content: center;
                align-items: center;
                flex-direction: column;
                padding: 20px;
                min-height: auto;
                padding-bottom: 50px;
            }

            input:focus {
                outline: none;
            }

            .qrcode {
                margin-left: 0;
            }

            .stacked {
                display: flex;
                flex-direction: column;
                align-items: flex-start;
                text-align: left;
                margin-left: 0;
                padding: 20px;
            }

            .stacked p, .stacked a {
                margin: 0;
                padding: 5px 0;
                font-size: 1rem;
                line-height: 1.5;
                text-align: left;
            }

            a:visited {
                color: rgb(0, 102, 204);
            }

            @media (min-width: 1001px) {
                .submit_form {
                    width: 44vh;
                }

                .center {
                    margin-top: 100px;
                    min-height: calc(100vh - 200px);
                }

                .stacked {
                    margin-top: 30px;
                    margin-left: 39.84%;
                }
            }
        }
    </style>
</head>
<body>
    <h1 class="title">CREATE QRD</h1>

    <div class="center" style="margin-top: 100px;">
        <form id="qrd" class="submit_form" method="POST" action="/qrd">
            <div class="container">
                <div class="container">
                    <span class="static-label">raspi.kladnik.cc/qrd/</span>
                    <input id="new" name="new" class="new" required autofocus maxlength="16" type="text" autocomplete="off">
                </div>

                <input type="submit" class="set" value="Done">
            </div>
        </form>
    </div>

    <div class="center">
        <p style="color: rgb(255, 45, 45);">{{ error }}</p>
    </div>
    
    <div class="stacked">
        <p>{{ t1 }}</p>
        <a href="{{ link }}">{{ link }}</a>
        <p>{{ t2 }}</p>
        <img class="qrcode" src="{{ img_data }}" onerror="handleError()" />
        <form id="save_qr" class="submit_form" method="POST" action="/qrd">
            <input type="hidden" name="save_qr" value="{{ img_data }}">
            <input type="{{ vis }}" class="set" style="width: 41%; margin-top: 5px;" value="Save">
        </form>
    </div>

    <script>
        function adjustLayoutForKeyboard() {
            const isMobile = window.innerWidth <= 1000;
            const body = document.body;
            const windowHeight = window.innerHeight;

            if (isMobile && windowHeight < 600) { 
                body.classList.add('keyboard-open');
            } else {
                body.classList.remove('keyboard-open');
            }

            const activeElement = document.activeElement;
            if (activeElement.tagName === "INPUT" || activeElement.tagName === "TEXTAREA") {
                activeElement.scrollIntoView({ behavior: 'smooth', block: 'center' });
            }
        }

        window.addEventListener('resize', adjustLayoutForKeyboard);
        window.addEventListener('orientationchange', adjustLayoutForKeyboard);
    </script>
</body>
</html>
